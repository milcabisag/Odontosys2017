<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="historial_medico" language="groovy" pageWidth="612" pageHeight="1008" columnWidth="572" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isFloatColumnFooter="true" uuid="8872015c-8cf2-4457-84ea-b70d942f40d3">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.callouts" value="##Tue Jul 08 13:07:46 PYT 2014"/>
	<parameter name="idPaciente" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="fecha_ini" class="java.lang.String">
		<parameterDescription><![CDATA[]]></parameterDescription>
	</parameter>
	<parameter name="fecha_fin" class="java.lang.String">
		<parameterDescription><![CDATA[]]></parameterDescription>
	</parameter>
	<parameter name="fechas" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
    paciente.nombres AS pac_nombre,
    paciente.apellidos AS pac_ape,
    paciente.nro_ci AS pac_ci,
    odontograma.fecha AS fecha,
	servicio.descripcion AS servicio,
	diente.nombre AS diente,
	detalle_orden.precio AS monto,
	datos.nombre_empresa,
	datos.nombre_propietario,
	datos.actividad,
	datos.direccion,
	datos.ciudad,
	datos.telefono
FROM
    paciente JOIN odontograma ON paciente.idPaciente = odontograma.fk_paciente
	JOIN tratamiento ON tratamiento.fk_odontograma = odontograma.idodontograma
	JOIN servicio ON servicio.idservicio =  tratamiento.fk_servicio
	JOIN diente ON diente.iddiente = tratamiento.fk_diente
	JOIN orden_servicio ON odontograma.idodontograma = orden_servicio.fk_odontograma
	JOIN detalle_orden ON detalle_orden.fk_orden_servicio = orden_servicio.idorden_servicio	
	JOIN datos
WHERE
     datos.iddatos = 1 AND paciente.idPaciente = $P{idPaciente} AND servicio.descripcion NOT LIKE '%Consulta%' AND odontograma.fecha BETWEEN $P{fecha_ini} AND $P{fecha_fin}
ORDER BY 	odontograma.fecha ASC]]>
	</queryString>
	<field name="pac_nombre" class="java.lang.String"/>
	<field name="pac_ape" class="java.lang.String"/>
	<field name="pac_ci" class="java.lang.Integer"/>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="servicio" class="java.lang.String"/>
	<field name="diente" class="java.lang.String"/>
	<field name="monto" class="java.lang.Integer"/>
	<field name="nombre_empresa" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombre_propietario" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="actividad" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="direccion" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ciudad" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="telefono" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="total_monto" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{monto}]]></variableExpression>
	</variable>
	<title>
		<band height="127" splitType="Stretch">
			<rectangle radius="10">
				<reportElement x="0" y="0" width="561" height="45" uuid="ef9bff59-c5ce-408e-baeb-16d2e523b431"/>
			</rectangle>
			<staticText>
				<reportElement mode="Opaque" x="0" y="46" width="561" height="30" forecolor="#006699" backcolor="#EEEDFF" uuid="993a1dd0-a8c5-4658-a73e-418ad0cba4c9"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="SansSerif" size="20" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="1_1_2"/>
				</textElement>
				<text><![CDATA[Historial Médico]]></text>
			</staticText>
			<textField>
				<reportElement x="260" y="31" width="300" height="14" uuid="d65b4fc0-033d-4afe-85dd-2f325a8cb237"/>
				<textElement textAlignment="Left" markup="none">
					<font size="8" isBold="false" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Dirección: "+$F{direccion}+" - "+$F{ciudad}+"  -  Teléfono: "+$F{telefono}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="10" width="250" height="29" uuid="b8b05fa8-108e-4572-99eb-33b471878935"/>
				<textElement textAlignment="Center" markup="none">
					<font size="20" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombre_empresa}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="260" y="17" width="300" height="13" uuid="2c7a281d-7c85-4647-af3a-bd2e06f64932"/>
				<textElement textAlignment="Left" markup="none">
					<font size="10" isBold="false" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{actividad}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="260" y="3" width="300" height="13" uuid="8c31702f-574f-45c7-be29-47759995d1cd"/>
				<textElement textAlignment="Left" markup="none">
					<font size="10" isBold="true" isItalic="true"/>
				</textElement>
				<textFieldExpression><![CDATA["De "+$F{nombre_propietario}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="0" y="101" width="100" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="a904ce2d-c609-43bf-a8d0-12567f3ffd4a"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Paciente]]></text>
			</staticText>
			<textField>
				<reportElement x="100" y="101" width="240" height="25" uuid="b1e05f29-85f2-44b1-90d5-7db26c7aeeec"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pac_nombre}+" "+$F{pac_ape}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="466" y="101" width="94" height="25" uuid="0e30efad-b453-47a7-a180-0b5a1ee845fc"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10"/>
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pac_ci}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="340" y="101" width="126" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="e7e3769e-02fb-4164-be13-83124105fdf6"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[C.I. Nro]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement mode="Opaque" x="0" y="78" width="561" height="20" forecolor="#006699" backcolor="#EEEDFF" uuid="637e4ec8-ef15-4412-9fdd-4bc61402eec9"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font size="10" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{fechas}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="25">
			<staticText>
				<reportElement mode="Opaque" x="340" y="0" width="126" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="8c429eeb-7b97-4918-8342-13afea98a4fb"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Diente]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="100" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="0df4c69d-dcf6-4cfe-8d7d-4957e89355b7"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="100" y="0" width="240" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="e3af3bd2-6024-4c39-8766-aea59c79e6c6"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Servicio]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="466" y="0" width="95" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="d3ca9a57-44e3-4d37-8837-c9b7f2e2d83d"/>
				<box>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Monto]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="28">
			<line direction="BottomUp">
				<reportElement positionType="Float" x="0" y="26" width="560" height="1" forecolor="#006699" uuid="7537b6bb-64ba-4da9-95e1-c63249aee915"/>
				<graphicElement>
					<pen lineWidth="2.5" lineStyle="Double"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement x="100" y="0" width="240" height="25" uuid="1303ffb5-44fb-4f6b-b74f-ca337fc40cc6"/>
				<box leftPadding="3">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{servicio}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="0" y="0" width="100" height="25" uuid="15776108-c8b1-4005-8634-01dfd37f0054"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="340" y="0" width="126" height="25" uuid="f16b7638-dcc1-4a2a-b530-aeba91ac959d"/>
				<box leftPadding="3">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{diente}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="466" y="0" width="95" height="25" uuid="85f5c37c-092d-475e-8302-4286728edaf0"/>
				<box>
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<paragraph leftIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{monto}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="30">
			<staticText>
				<reportElement mode="Opaque" x="0" y="3" width="380" height="25" forecolor="#006699" backcolor="#EEEDFF" uuid="a754c692-01e1-4659-9522-4eb3382a3e33"/>
				<box rightPadding="3">
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<textField pattern="#,##0">
				<reportElement x="421" y="3" width="139" height="25" uuid="5257e8fd-5f23-4b9a-9f8f-ae91f9459651"/>
				<box>
					<pen lineWidth="0.25" lineStyle="Double"/>
					<topPen lineWidth="0.25" lineStyle="Double"/>
					<leftPen lineWidth="0.25" lineStyle="Double"/>
					<bottomPen lineWidth="0.25" lineStyle="Double"/>
					<rightPen lineWidth="0.25" lineStyle="Double"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_monto}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Transparent" x="381" y="3" width="40" height="25" forecolor="#000000" backcolor="#FFFFFF" uuid="2de6652e-b252-4e99-90e4-b9a23f1410f8"/>
				<box rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.25"/>
					<leftPen lineWidth="0.25"/>
					<bottomPen lineWidth="0.25"/>
					<rightPen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="SansSerif" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Gs.]]></text>
			</staticText>
		</band>
	</columnFooter>
</jasperReport>
